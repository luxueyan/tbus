
<div id="login">

    <nav class="container page-nav">
    <div class="row">
        <a class="col-xs-3 back"
           ng-if="self.step === 'one'"
           ng-href="{{ self.back_path || './' }}"
        ><param class="glyphicon glyphicon-menu-left"></a>

        <a class="col-xs-3 back"
           ng-href="{{ is_login_successful && (self.back_path || './') }}"
           ng-if="self.step === 'two'"
           ng-click="!is_login_successful && (self.step = 'one')"
        ><param class="glyphicon glyphicon-menu-left"></a>

        <span class="col-xs-6 title">
            <span ng-if="self.bind_weixin">绑定微信</span>
            <span ng-if="!self.bind_weixin">
                <span ng-show="self.step === 'one'">手机号</span>
                <span ng-show="self.step === 'two'">
                    {{ is_login_successful ? '登录成功' : '输入密码' }}
                </span>
            </span>
        </span>
        <span class="col-xs-3">&nbsp;</span>
    </div>
    </nav>

    <div>
        <param ng-model="msg" ng-init="msg = {
            TOO_MANY_ATTEMPT: '账号密码错误次数过多，您的账户已被锁定，请联系客服 400-756-6888 解锁。',
            USER_DISABLED: '对不起，您的用户已被冻结，如有疑问，烦请联系客服，400-756-6888，谢谢',
        }">
    </div>

    <div class="page-content">

        <div class="logo"><img width="104" ng-src="assets/image/logo.png"></div>

        <form class="form-flatten form-horizontal" name="form" ng-submit="self.login(store)" novalidate>

            <p class="container hint"
               ng-show="self.step === 'one'"
            >请输入手机号注册或登录</p>

            <p class="container hint"
               ng-show="self.step === 'two'"
            >您已经注册过，请输入登录密码</p>

            <div class="inputs container">
                <div class="form-group merge"
                     ng-if="self.step === 'one'"
                     ng-class="{
                        'has-error': form.mobile.$invalid && form.mobile.$dirty
                     }"
                >
                    <div class="form-group-inner">
                        <label for="mobile">手机号</label>
                        <div class="form-control-wrap">
                            <input class="form-control input-target input-lg" type="tel"
                                   id="mobile"
                                   name="mobile"
                                   autocapitalize="none"
                                   autocomplete="off"
                                   autocorrect="off"
                                   placeholder="请输入11位有效手机号"
                                   ng-model="store.mobile"
                                   ng-pattern="/^1\d{10}$/"
                                   maxlength="11"
                                   required
                            >
                        </div>
                    </div>

                    <div class="help-block"
                         ng-show="form.mobile.$invalid && form.mobile.$dirty"
                    >
                        <span ng-show="form.mobile.$error.required">必须填写</span>
                        <span ng-show="form.mobile.$error.pattern">请输入11位有效手机号</span>
                    </div>
                </div>

                <div class="form-group merge"
                     ng-if="self.step === 'two'"
                     ng-class="{
                         'has-error': form.password.$invalid && form.password.$dirty
                     }"
                >
                    <div class="form-group-inner">
                        <label for="password">密&#x3000;码</label>
                        <div class="form-control-wrap">
                            <input class="form-control input-target input-lg" type="password"
                                   id="password"
                                   name="password"
                                   ng-model="store.password"
                                   minlength="8"
                                   placeholder="请输入登录密码"
                                   required
                            >
                        </div>
                    </div>

                    <div class="help-block"
                         ng-show="form.password.$invalid && form.password.$dirty"
                    >
                        <span ng-show="form.password.$invalid">至少8位</span>
                    </div>
                </div>
            </div>

            <div class="container" ng-if="self.step === 'one'">
                <p class="hint hint-mobile">我们不会在任何情况泄露您的手机号，请放心</p>

                <div class="form-group container">
                    <button type="submit" class="btn btn-theme btn-block btn-lg"
                            ng-disabled="form.mobile.$invalid || self.submit_sending"
                    >下一步</button>
                </div>
            </div>

            <div class="container" ng-if="self.step === 'two'">
                <div class="flash-message text-center"
                     ng-class="{ on: self.flashing_error_message }"
                >手机号 或 密码错误</div>

                <div class="form-group container">
                    <button type="submit" class="btn btn-theme btn-block btn-lg"
                            ng-disabled="form.$invalid || self.submit_sending"
                    >下一步</button>
                </div>

                <p class="links text-center">
                    <a ng-href="password/forgot?back={{ page_path }}">忘记密码？</a>
                    <a href="" ng-click="self.goto('register')" x-gyro-comment>免费注册</a>
                </p>
            </div>
        </form>

    </div>

</div>
